# PySchedule - Pythonä»»åŠ¡è°ƒåº¦å¹³å°

![Version](https://img.shields.io/badge/version-2.5.0-blue.svg)
![Python](https://img.shields.io/badge/python-3.8+-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)

> ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Pythonä»»åŠ¡è°ƒåº¦å’Œç®¡ç†å¹³å°ï¼Œæ”¯æŒå®šæ—¶ä»»åŠ¡ã€åœ¨çº¿ç¼–è¾‘ã€æ•°æ®åº“é…ç½®ã€å®¡è®¡æ—¥å¿—ç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚

---

## ğŸ“‘ æ–‡æ¡£å¯¼èˆª

ğŸ“„ **æœ¬æ–‡æ¡£** - é¡¹ç›®ä»‹ç»ã€åŠŸèƒ½ç‰¹æ€§ã€æŠ€æœ¯æ ˆã€é¡¹ç›®ç»“æ„  
ğŸ“„ **[DEPLOY.md](./DEPLOY.md)** - ğŸš€ **æ–°æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—**ï¼ˆæ¨èä»è¿™é‡Œå¼€å§‹ï¼‰  
ğŸ“„ **[GIT_UPLOAD_GUIDE.md](./GIT_UPLOAD_GUIDE.md)** - Gitä»“åº“ä¸Šä¼ å’Œåˆ†äº«æŒ‡å—

---

## ğŸ“– ç›®å½•

- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [åŠŸèƒ½æ¨¡å—](#åŠŸèƒ½æ¨¡å—)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ ä»»åŠ¡ç®¡ç†
- âœ… **å¯è§†åŒ–ä»»åŠ¡è°ƒåº¦** - åŸºäºAPSchedulerçš„Cronè¡¨è¾¾å¼å®šæ—¶ä»»åŠ¡
- âœ… **åœ¨çº¿ä»£ç ç¼–è¾‘** - å†…ç½®Monaco Editorï¼Œæ”¯æŒPythonè¯­æ³•é«˜äº®å’Œæ™ºèƒ½æç¤º
- âœ… **å®æ—¶æ—¥å¿—æŸ¥çœ‹** - ä»»åŠ¡æ‰§è¡Œæ—¥å¿—å®æ—¶æ˜¾ç¤ºï¼Œæ”¯æŒä¸‹è½½
- âœ… **å¤šå‚æ•°æ”¯æŒ** - æ”¯æŒJSON/YAMLé…ç½®ã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°
- âœ… **æ‰¹é‡æ“ä½œ** - æ‰¹é‡å¯ç”¨/ç¦ç”¨/åˆ é™¤ä»»åŠ¡
- âœ… **ä»»åŠ¡ç­›é€‰** - ç®¡ç†å‘˜å¯æŒ‰åˆ›å»ºè€…ç­›é€‰ä»»åŠ¡

### ğŸ”§ å·¥ä½œåŒº
- âœ… **æ–‡ä»¶ç®¡ç†** - å¤šç”¨æˆ·éš”ç¦»çš„Pythonè„šæœ¬å·¥ä½œåŒº
- âœ… **åœ¨çº¿ç¼–è¾‘å™¨** - æ”¯æŒPythonã€JSONã€YAMLã€Textç­‰å¤šç§æ–‡ä»¶ç±»å‹
- âœ… **WebSocketç»ˆç«¯æ‰§è¡Œ** - æ‰€æœ‰è„šæœ¬ç»Ÿä¸€ä½¿ç”¨WebSocketæ‰§è¡Œï¼Œå®æ—¶è¾“å‡ºï¼Œå¯éšæ—¶ç»ˆæ­¢
- âœ… **æ™ºèƒ½æ¨¡å¼è¯†åˆ«** - è‡ªåŠ¨æ£€æµ‹è„šæœ¬æ˜¯å¦åŒ…å«input()äº¤äº’æ“ä½œï¼Œæ™ºèƒ½é€‰æ‹©æ‰§è¡Œæ¨¡å¼
- âœ… **åŒé‡æ‰§è¡Œæ¨¡å¼** - éäº¤äº’å¼ï¼ˆè‡ªåŠ¨å…³é—­ï¼‰vs äº¤äº’å¼ï¼ˆæ‰‹åŠ¨å…³é—­ï¼Œæ”¯æŒè¾“å…¥ï¼‰
- âœ… **æ‰§è¡ŒçŠ¶æ€æç¤º** - æ˜æ˜¾çš„âœ“æˆåŠŸ/âœ—å¤±è´¥æç¤º+é€€å‡ºç ï¼Œç”¨æˆ·æ¸…æ¥šçŸ¥é“æ‰§è¡ŒçŠ¶æ€
- âœ… **éé˜»å¡æ‰§è¡Œ** - å¤šç”¨æˆ·å¹¶å‘æ‰§è¡Œäº’ä¸å½±å“ï¼Œå®Œå…¨å¼‚æ­¥
- âœ… **å®‰å…¨æ€§æ‰«æ** - æ‰§è¡Œå‰è‡ªåŠ¨æ£€æµ‹å±é™©æ“ä½œå’Œæ•°æ®åº“è¿æ¥
- âœ… **è¾“å‡ºæ–‡ä»¶** - è‡ªåŠ¨ç®¡ç†ä»»åŠ¡è¾“å‡ºçš„CSVã€Excelã€å›¾è¡¨ç­‰æ–‡ä»¶
- âœ… **Web SSHç»ˆç«¯** - å®Œæ•´çš„Shellè®¿é—®æƒé™ï¼ˆç®¡ç†å‘˜ä¸“ç”¨ï¼‰
- âœ… **é¢„è£…å¸¸ç”¨åŒ…** - pandasã€numpyã€openpyxlã€pymongoã€redisç­‰å¼€ç®±å³ç”¨

### ğŸ’¾ æ•°æ®åº“é…ç½®
- âœ… **å¤šæ•°æ®åº“æ”¯æŒ** - MongoDBã€MySQLã€PostgreSQLã€Redis
- âœ… **åŠ¨æ€å¯¼å…¥** - é€šè¿‡`from db_configs import xxx`ç›´æ¥ä½¿ç”¨é…ç½®
- âœ… **å¯†ç åŠ å¯†** - AES-256åŠ å¯†å­˜å‚¨æ•°æ®åº“å¯†ç 
- âœ… **é…ç½®ç®¡ç†** - Webç•Œé¢å¯è§†åŒ–ç®¡ç†æ•°æ®åº“è¿æ¥
- âœ… **ä½¿ç”¨ç¤ºä¾‹** - è‡ªåŠ¨ç”ŸæˆPythonä»£ç ç¤ºä¾‹

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- âœ… **è§’è‰²æƒé™** - ç®¡ç†å‘˜/æ™®é€šç”¨æˆ·è§’è‰²åˆ†ç¦»
- âœ… **åœ¨çº¿çŠ¶æ€** - å®æ—¶æ˜¾ç¤ºç”¨æˆ·åœ¨çº¿/ç¦»çº¿çŠ¶æ€
- âœ… **ä¸ªäººè®¾ç½®** - ç”¨æˆ·å¯ä¿®æ”¹å¯†ç 
- âœ… **å®¡è®¡æ—¥å¿—** - è¯¦ç»†è®°å½•ç”¨æˆ·æ“ä½œè¡Œä¸º

### ğŸ” å®‰å…¨ç‰¹æ€§
- âœ… **JWTè®¤è¯** - åŸºäºTokençš„èº«ä»½éªŒè¯
- âœ… **éªŒè¯ç ** - èµ›åšæœ‹å…‹é£æ ¼çš„CanvaséªŒè¯ç 
- âœ… **å¯†ç åŠ å¯†** - bcryptå“ˆå¸Œå­˜å‚¨
- âœ… **æƒé™æ§åˆ¶** - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- âœ… **å®¡è®¡è¿½è¸ª** - IPåœ°å€ã€æ“ä½œè®°å½•ã€æ—¶é—´è¿½è¸ª

### ğŸ¨ ç•Œé¢è®¾è®¡
- âœ… **èµ›åšæœ‹å…‹ç™»å½•é¡µ** - éœ“è™¹é£æ ¼ã€åŠ¨æ€èƒŒæ™¯ã€æ‰“å­—æœºæ•ˆæœ
- âœ… **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯
- âœ… **ç°ä»£UI** - Ant Design + Tailwind CSS
- âœ… **æµç•…åŠ¨ç”»** - Framer Motionå¹³æ»‘è¿‡æ¸¡

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| **Python** | 3.8+ | æ ¸å¿ƒè¯­è¨€ |
| **FastAPI** | æœ€æ–° | Webæ¡†æ¶ |
| **SQLAlchemy** | æœ€æ–° | ORMæ¡†æ¶ |
| **APScheduler** | 3.x | ä»»åŠ¡è°ƒåº¦ |
| **PyMongo** | æœ€æ–° | MongoDBé©±åŠ¨ |
| **SQLite** | 3.x | é»˜è®¤æ•°æ®åº“ |
| **Cryptography** | æœ€æ–° | å¯†ç åŠ å¯† |
| **Pydantic** | æœ€æ–° | æ•°æ®éªŒè¯ |

### å‰ç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| **React** | 18.x | UIæ¡†æ¶ |
| **TypeScript** | 5.x | ç±»å‹å®‰å…¨ |
| **Vite** | 6.x | æ„å»ºå·¥å…· |
| **Ant Design** | 5.x | ç»„ä»¶åº“ |
| **Tailwind CSS** | 3.x | æ ·å¼æ¡†æ¶ |
| **Monaco Editor** | æœ€æ–° | ä»£ç ç¼–è¾‘å™¨ |
| **Framer Motion** | æœ€æ–° | åŠ¨ç”»åº“ |
| **Xterm.js** | 5.x | ç»ˆç«¯æ¨¡æ‹Ÿå™¨ |
| **Lucide React** | æœ€æ–° | å›¾æ ‡åº“ |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Docker & Docker Compose
- è‡³å°‘2GBå†…å­˜
- ç«¯å£3001ï¼ˆå‰ç«¯ï¼‰ã€8088ï¼ˆåç«¯ï¼‰ã€3306ï¼ˆæ•°æ®åº“ï¼‰å¯ç”¨

### âš ï¸ é‡è¦ï¼šå¤–éƒ¨Nginxé…ç½®

å¦‚æœä½¿ç”¨å¤–éƒ¨Nginxä»£ç†ï¼Œ**å¿…é¡»æ·»åŠ WebSocketæ”¯æŒ**ï¼Œå¦åˆ™ç»ˆç«¯æ‰§è¡ŒåŠŸèƒ½æ— æ³•ä½¿ç”¨ã€‚

#### å®Œæ•´é…ç½®ç¤ºä¾‹

```nginx
# ====================================================
# Pythonå®šæ—¶ä»»åŠ¡ç®¡ç†å¹³å° - å¤–éƒ¨Nginxä»£ç†é…ç½®
# ====================================================
# åŸŸåç¤ºä¾‹: jump.winteamiot.com
# è¯´æ˜: ä½¿ç”¨ /python/ ç»Ÿä¸€å‰ç¼€ï¼Œé¿å…ä¸å…¶ä»–æœåŠ¡çš„ /api/ è·¯å¾„å†²çª
# ====================================================

# Pythonæ‰§è¡ŒæœåŠ¡ - ç»Ÿä¸€ä»£ç†ï¼ˆå‰ç«¯ + åç«¯APIï¼‰
location /python/ {
    # ä»£ç†åˆ°å‰ç«¯å®¹å™¨ï¼ˆç«¯å£3001ï¼‰
    proxy_pass http://192.168.31.214:3001/python/;
    
    # ========== çœŸå®IPä¼ é€’ï¼ˆé‡è¦ï¼‰==========
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    
    # ========== WebSocketæ”¯æŒï¼ˆäº¤äº’å¼ç»ˆç«¯éœ€è¦ï¼‰==========
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    
    # ========== è¶…æ—¶è®¾ç½® ==========
    proxy_connect_timeout 75s;
    proxy_send_timeout 300s;
    proxy_read_timeout 300s;
    
    # ========== æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ ==========
    client_max_body_size 100M;
}
```

#### è·¯å¾„è¯´æ˜

- **å‰ç«¯è®¿é—®**: `https://jump.winteamiot.com/python/`
- **APIè®¿é—®**: `https://jump.winteamiot.com/python/api/auth/login`
- **WebSocket**: `wss://jump.winteamiot.com/python/api/ws/terminal`

**å†…éƒ¨è·¯ç”±**ï¼š
- `/python/` â†’ å‰ç«¯é¡µé¢
- `/python/api/` â†’ åç«¯APIï¼ˆå†…éƒ¨Nginxä¼šè½¬å‘åˆ°backend:8088/api/ï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… åªéœ€ä¸€ä¸ª location é…ç½®
- âœ… é¿å…ä¸å…¶ä»–æœåŠ¡çš„ /api/ å†²çª
- âœ… WebSocketè‡ªåŠ¨æ”¯æŒ
- âœ… çœŸå®IPæ­£ç¡®ä¼ é€’

#### SSL/HTTPSé…ç½®ï¼ˆå¯é€‰ï¼‰

```nginx
# HTTPSæœåŠ¡å™¨
server {
    listen 443 ssl http2;
    server_name jump.winteamiot.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    location /python/ {
        proxy_pass http://192.168.31.214:3001/python/;
        # ... åŒä¸Šé…ç½®
    }
}

# HTTPé‡å®šå‘åˆ°HTTPS
server {
    listen 80;
    server_name jump.winteamiot.com;
    return 301 https://$server_name$request_uri;
}
```
### ç¯å¢ƒè¦æ±‚
```bash
- Docker 20.10+
- Docker Compose 2.0+
```

### ğŸ³ Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd exec_python_web/v2
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ä¿®æ”¹æ•°æ®åº“å¯†ç ç­‰é…ç½®
```

#### 3. ä¸€é”®å¯åŠ¨
```bash
docker-compose up -d
```

æœåŠ¡ä¼šè‡ªåŠ¨ï¼š
- âœ… åˆ›å»ºMySQLæ•°æ®åº“å¹¶åˆå§‹åŒ–è¡¨ç»“æ„
- âœ… åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼ˆadmin/admin123ï¼‰
- âœ… å®‰è£…æ‰€æœ‰Pythonä¾èµ–ï¼ˆåŒ…æ‹¬é¢„è£…çš„å¸¸ç”¨åŒ…ï¼‰
- âœ… æ„å»ºå¹¶å¯åŠ¨å‰åç«¯æœåŠ¡
- âœ… é…ç½®Nginxåå‘ä»£ç†

#### 4. è®¿é—®ç³»ç»Ÿ
```
å‰ç«¯ç•Œé¢: http://localhost/python/
åç«¯APIæ–‡æ¡£: http://localhost/python/api/docs
```

#### 5. æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend
```

#### 6. åœæ­¢æœåŠ¡
```bash
docker-compose down
```

### ğŸ“ æ•°æ®æŒä¹…åŒ–

æ‰€æœ‰é‡è¦æ•°æ®éƒ½å·²æŒ‚è½½åˆ°ä¸»æœºï¼š
```
volumes/
â”œâ”€â”€ mysql/          # æ•°æ®åº“æ•°æ®
â”œâ”€â”€ work/           # ç”¨æˆ·å·¥ä½œåŒºï¼ˆè„šæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ uploads/        # ä¸Šä¼ æ–‡ä»¶
â””â”€â”€ task_data/      # ä»»åŠ¡è¾“å…¥è¾“å‡ºæ•°æ®

logs/
â”œâ”€â”€ backend/        # åç«¯æ—¥å¿—
â””â”€â”€ task_logs/      # ä»»åŠ¡æ‰§è¡Œæ—¥å¿—

backend/requirements.txt  # PythonåŒ…åˆ—è¡¨ï¼ˆæŒä¹…åŒ–ï¼‰
```

### ğŸ”§ å®¹å™¨é‡å»º

å½“éœ€è¦æ›´æ–°ä»£ç æˆ–é‡å»ºå®¹å™¨æ—¶ï¼š
```bash
# é‡å»ºæ‰€æœ‰æœåŠ¡
docker-compose down
docker-compose build
docker-compose up -d

# é‡å»ºå•ä¸ªæœåŠ¡
docker-compose build backend
docker-compose up -d backend
```

> ğŸ’¡ **æ•°æ®åº“ä¼šè‡ªåŠ¨è¿ç§»**ï¼šå®¹å™¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶æ·»åŠ æ–°å¢çš„è¡¨å­—æ®µï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

### é»˜è®¤è´¦æˆ·
```
ç”¨æˆ·å: admin
å¯†ç : admin123
è§’è‰²: ç®¡ç†å‘˜
æƒé™: å®Œå…¨æƒé™ï¼ˆåŒ…æ‹¬åŒ…ç®¡ç†ï¼‰
```

> âš ï¸ **ç”Ÿäº§ç¯å¢ƒè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼**

---

## ğŸ“¦ åŠŸèƒ½æ¨¡å—

### 1. ä»ªè¡¨ç›˜
- **ç»Ÿè®¡æ¦‚è§ˆ** - æ€»ä»»åŠ¡æ•°ã€è¿è¡Œä¸­ä»»åŠ¡ã€å·²å®Œæˆä»»åŠ¡ã€ä»»åŠ¡æˆåŠŸç‡
- **è¿‘æœŸä»»åŠ¡** - æœ€è¿‘10ä¸ªä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€
- **å¿«æ·å…¥å£** - å¿«é€Ÿè®¿é—®ä»»åŠ¡ç®¡ç†ã€å·¥ä½œåŒºç­‰åŠŸèƒ½

### 2. ä»»åŠ¡ç®¡ç†

#### åˆ›å»ºä»»åŠ¡
```python
# æ”¯æŒä¸‰ç§å‚æ•°æ–¹å¼

# æ–¹å¼1ï¼šç¯å¢ƒå˜é‡
import os
task_id = os.getenv('TASK_ID')
output_dir = os.getenv('OUTPUT_DIR')
exec_date = os.getenv('EXEC_DATE')

# æ–¹å¼2ï¼šé…ç½®æ–‡ä»¶
import json
with open('config.json') as f:
    config = json.load(f)

# æ–¹å¼3ï¼šå‘½ä»¤è¡Œå‚æ•°
import argparse
parser = argparse.ArgumentParser()
parser.add_argument('--start-date', required=True)
args = parser.parse_args()
```

#### Cronè¡¨è¾¾å¼ç¤ºä¾‹
```bash
# æ¯åˆ†é’Ÿæ‰§è¡Œ
* * * * *

# æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
0 2 * * *

# æ¯å‘¨ä¸€ä¸Šåˆ9ç‚¹æ‰§è¡Œ
0 9 * * MON

# æ¯æœˆ1å·å‡Œæ™¨1ç‚¹æ‰§è¡Œ
0 1 1 * *

# æ¯å°æ—¶çš„ç¬¬15åˆ†é’Ÿæ‰§è¡Œ
15 * * * *
```

### 3. å·¥ä½œåŒº

#### æ–‡ä»¶ç»“æ„
```
work/
â”œâ”€â”€ admin/          # ç®¡ç†å‘˜å·¥ä½œç›®å½•
â”œâ”€â”€ user1/          # ç”¨æˆ·1å·¥ä½œç›®å½•
â””â”€â”€ user2/          # ç”¨æˆ·2å·¥ä½œç›®å½•
```

#### æ”¯æŒçš„æ–‡ä»¶ç±»å‹
- **Python** (.py) - è¯­æ³•é«˜äº®ã€æ™ºèƒ½æç¤º
- **JSON** (.json) - æ ¼å¼åŒ–ã€éªŒè¯
- **YAML** (.yaml, .yml) - è¯­æ³•æ”¯æŒ
- **Text** (.txt, .md, .log) - çº¯æ–‡æœ¬ç¼–è¾‘
- **CSV** (.csv) - æ•°æ®æ–‡ä»¶
- **Excel** (.xlsx) - æ•°æ®æ–‡ä»¶

### 4. æ•°æ®åº“é…ç½®

#### åˆ›å»ºé…ç½®
1. è®¿é—® **æ•°æ®åº“é…ç½®** é¡µé¢
2. ç‚¹å‡» **æ–°å¢é…ç½®**
3. å¡«å†™è¿æ¥ä¿¡æ¯
4. ç‚¹å‡» **æµ‹è¯•è¿æ¥**
5. ä¿å­˜é…ç½®

#### ä½¿ç”¨é…ç½®
```python
# åœ¨Pythonè„šæœ¬ä¸­ä½¿ç”¨
from db_configs import mongo_prod as mongos

# è·å–æ•°æ®åº“è¿æ¥
client = mongos.client
db = client['your_database']
collection = db['your_collection']

# æŸ¥è¯¢ç¤ºä¾‹
results = collection.find({'status': 'active'})
for doc in results:
    print(doc)

# æ’å…¥ç¤ºä¾‹
collection.insert_one({'name': 'test', 'value': 123})

# å…³é—­è¿æ¥
client.close()
```

#### åˆ‡æ¢ç¯å¢ƒ
```python
# æµ‹è¯•ç¯å¢ƒ
from db_configs import mongo_test as mongos

# ç”Ÿäº§ç¯å¢ƒ
from db_configs import mongo_prod as mongos

# å¼€å‘ç¯å¢ƒ
from db_configs import mongo_dev as mongos
```

### 5. ç”¨æˆ·ç®¡ç†

#### ç”¨æˆ·è§’è‰²
- **ç®¡ç†å‘˜ (admin)** - æ‰€æœ‰æƒé™ï¼Œå¯ç®¡ç†ç”¨æˆ·ã€æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡
- **æ™®é€šç”¨æˆ· (user)** - åªèƒ½ç®¡ç†è‡ªå·±åˆ›å»ºçš„ä»»åŠ¡å’Œæ–‡ä»¶

#### åŠŸèƒ½æƒé™
| åŠŸèƒ½ | ç®¡ç†å‘˜ | æ™®é€šç”¨æˆ· |
|-----|--------|---------|
| åˆ›å»ºä»»åŠ¡ | âœ… | âœ… |
| æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡ | âœ… | âŒ |
| ç”¨æˆ·ç®¡ç† | âœ… | âŒ |
| å®¡è®¡æ—¥å¿— | âœ… | âŒ |
| æ•°æ®åº“é…ç½® | âœ… | âœ… |
| ä¸ªäººå·¥ä½œåŒº | âœ… | âœ… |

### 6. å®¡è®¡æ—¥å¿—

#### è®°å½•å†…å®¹
- **ç”¨æˆ·æ“ä½œ** - ç™»å½•ã€ç™»å‡ºã€åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤
- **IPåœ°å€** - è®°å½•æ“ä½œæ¥æºIP
- **æ—¶é—´æˆ³** - ç²¾ç¡®åˆ°ç§’çš„æ“ä½œæ—¶é—´
- **è¯¦ç»†ä¿¡æ¯** - JSONæ ¼å¼çš„æ“ä½œè¯¦æƒ…

#### æ—¥å¿—æ¸…ç†
- **æŒ‰æ—¥æœŸèŒƒå›´æ¸…ç†** - æŒ‡å®šå¼€å§‹å’Œç»“æŸæ—¥æœŸ
- **ä¿ç•™æœ€æ–°æ—¥å¿—** - è‡ªåŠ¨ä¿ç•™æŒ‡å®šæ¡æ•°çš„æœ€æ–°æ—¥å¿—
- **æ‰¹é‡åˆ é™¤** - æ”¯æŒå¤§é‡æ—¥å¿—çš„é«˜æ•ˆåˆ é™¤

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
v1/
â”œâ”€â”€ backend/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ routers/               # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.py           # è®¤è¯æ¥å£
â”‚   â”‚   â”œâ”€â”€ tasks.py          # ä»»åŠ¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ users.py          # ç”¨æˆ·æ¥å£
â”‚   â”‚   â”œâ”€â”€ workspace.py      # å·¥ä½œåŒºæ¥å£
â”‚   â”‚   â”œâ”€â”€ database.py       # æ•°æ®åº“é…ç½®æ¥å£
â”‚   â”‚   â”œâ”€â”€ audit.py          # å®¡è®¡æ—¥å¿—æ¥å£
â”‚   â”‚   â””â”€â”€ terminal.py       # ç»ˆç«¯æ¥å£
â”‚   â”œâ”€â”€ models.py              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ schemas.py             # Pydanticæ¨¡å‹
â”‚   â”œâ”€â”€ database.py            # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ auth.py                # è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ audit.py               # å®¡è®¡æ—¥å¿—
â”‚   â”œâ”€â”€ config.py              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ scheduler.py           # ä»»åŠ¡è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ db_configs/            # æ•°æ®åº“é…ç½®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py       # åŠ¨æ€å¯¼å…¥å®ç°
â”‚   â”‚   â””â”€â”€ README.md         # ä½¿ç”¨è¯´æ˜
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ crypto.py         # åŠ å¯†è§£å¯†
â”‚   â”‚   â””â”€â”€ ip_utils.py       # IPå·¥å…·
â”‚   â”œâ”€â”€ work/                  # ç”¨æˆ·å·¥ä½œåŒº
â”‚   â””â”€â”€ main.py                # åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ frontend/                   # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # Reactç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout.tsx    # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ PrivateRoute.tsx  # è·¯ç”±å®ˆå«
â”‚   â”‚   â”‚   â””â”€â”€ login/        # ç™»å½•é¡µç»„ä»¶
â”‚   â”‚   â”‚       â”œâ”€â”€ Background.tsx     # èƒŒæ™¯åŠ¨ç”»
â”‚   â”‚   â”‚       â”œâ”€â”€ Captcha.tsx        # éªŒè¯ç ç»„ä»¶
â”‚   â”‚   â”‚       â”œâ”€â”€ Input.tsx          # è¾“å…¥æ¡†ç»„ä»¶
â”‚   â”‚   â”‚       â”œâ”€â”€ Button.tsx         # æŒ‰é’®ç»„ä»¶
â”‚   â”‚   â”‚       â””â”€â”€ Typewriter.tsx     # æ‰“å­—æœºæ•ˆæœ
â”‚   â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginNew.tsx   # ç™»å½•é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx  # ä»ªè¡¨ç›˜
â”‚   â”‚   â”‚   â”œâ”€â”€ Tasks.tsx      # ä»»åŠ¡ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ Workspace.tsx  # å·¥ä½œåŒº
â”‚   â”‚   â”‚   â”œâ”€â”€ DatabaseConfig.tsx  # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ Users.tsx      # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ AuditLogs.tsx  # å®¡è®¡æ—¥å¿—
â”‚   â”‚   â”‚   â””â”€â”€ Profile.tsx    # ä¸ªäººè®¾ç½®
â”‚   â”‚   â”œâ”€â”€ contexts/          # React Context
â”‚   â”‚   â”‚   â””â”€â”€ AuthContext.tsx
â”‚   â”‚   â”œâ”€â”€ api/               # APIå°è£…
â”‚   â”‚   â”‚   â””â”€â”€ axios.ts
â”‚   â”‚   â””â”€â”€ App.tsx            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ public/                # é™æ€èµ„æº
â”‚   â”œâ”€â”€ tailwind.config.js     # Tailwindé…ç½®
â”‚   â”œâ”€â”€ postcss.config.js      # PostCSSé…ç½®
â”‚   â”œâ”€â”€ vite.config.ts         # Viteé…ç½®
â”‚   â””â”€â”€ package.json           # ä¾èµ–é…ç½®
â”‚
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ database.db            # SQLiteæ•°æ®åº“
â”‚   â””â”€â”€ task_output/           # ä»»åŠ¡è¾“å‡ºæ–‡ä»¶
â”‚
â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ backend.log            # åç«¯æ—¥å¿—
â”‚   â””â”€â”€ frontend.log           # å‰ç«¯æ—¥å¿—
â”‚
â”œâ”€â”€ setup.sh                    # å®‰è£…è„šæœ¬
â”œâ”€â”€ start.sh                    # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop.sh                     # åœæ­¢è„šæœ¬
â”œâ”€â”€ restart.sh                  # é‡å¯è„šæœ¬
â”œâ”€â”€ status.sh                   # çŠ¶æ€æ£€æŸ¥è„šæœ¬
â”œâ”€â”€ build_production.sh         # ç”Ÿäº§æ„å»ºè„šæœ¬
â”œâ”€â”€ nginx_production.conf       # Nginxé…ç½®
â”œâ”€â”€ .gitignore                  # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ SECURITY.md                 # å®‰å…¨è¯´æ˜
â”œâ”€â”€ TESTING.md                  # æµ‹è¯•è¯´æ˜
â””â”€â”€ PROJECT_README.md           # é¡¹ç›®æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### åç«¯é…ç½® (backend/config.py)
```python
DATABASE_URL = "sqlite:///./data/database.db"  # æ•°æ®åº“è·¯å¾„
SECRET_KEY = "your-secret-key-here"            # JWTå¯†é’¥
ENCRYPTION_KEY = "your-encryption-key"         # æ•°æ®åŠ å¯†å¯†é’¥
ACCESS_TOKEN_EXPIRE_MINUTES = 43200            # Tokenè¿‡æœŸæ—¶é—´ï¼ˆ30å¤©ï¼‰
WORK_DIR = "./work"                            # å·¥ä½œåŒºè·¯å¾„
OUTPUT_DIR = "./data/task_output"              # è¾“å‡ºæ–‡ä»¶è·¯å¾„
```

### å‰ç«¯é…ç½® (frontend/vite.config.ts)
```typescript
server: {
  port: 3001,                    # å‰ç«¯ç«¯å£
  proxy: {
    '/api': {
      target: 'http://localhost:8088',  # åç«¯åœ°å€
      changeOrigin: true,
    },
  },
}
```

### å†…ç½®Nginxé…ç½® (nginx_production.conf)
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location /python/ {
        alias /opt/soft/exec_python_web/v1/frontend/dist/;
        try_files $uri $uri/ /python/index.html;
    }
    
    location /api/ {
        proxy_pass http://localhost:8088;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```



### å¤–éƒ¨ä»£ç†nginxé…ç½®

```nginx
  location /python/ {
        proxy_pass http://192.168.31.214:3001/python/;
        
        # ========== å…³é”®ï¼WebSocketæ”¯æŒ ==========
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection $connection_upgrade;  # æˆ– "upgrade"
        
        # ========== åŸºæœ¬å¤´éƒ¨ ==========
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # ========== è¶…æ—¶è®¾ç½®ï¼ˆWebSocketéœ€è¦ï¼‰==========
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
        
        # æ–‡ä»¶ä¸Šä¼ 
        client_max_body_size 100M;
  }
        
```
